<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Caress</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Caress - Multitouch Love for All Browsers">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href='http://fonts.googleapis.com/css?family=Dancing+Script' rel='stylesheet' type='text/css'>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png">

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-35796697-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>

  <body>
    <!-- Navbar
    ================================================== -->
    <div class="navbar navbar-transparent">
      <div class="">
        <div class="container">
          <ul class="nav nav-pills pull-right">
            <li class="active"><a href="/">Home</a></li>
            <li><a href="/examples">Examples</a></li>
            <li><a href="#docs">Docs</a></li>
            <li><a href="https://github.com/ekryski/caress-server">Server</a></li>
            <li><a href="https://github.com/ekryski/caress-client">Client</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div id="wrap">
      <div class="container">
        <div class="row">
          <div class="span6">
            <img src="img/caress-logo.png">
          </div>
        </div>
        <div class="row">
          <div class="span12">
            <h3 class="tagline">Because all browsers want to be touched...</h3>
          </div>
        </div>
        <div class="row">
          <div class="span6 offset3">
            <iframe width="100%" height="315" src="http://www.youtube.com/embed/q-ZVhy9tTBo" frameborder="0" allowfullscreen></iframe>
          </div>
          </div> <!-- ./hero-unit -->
        </div>
        <!-- <div class="row">
          <div class="span6 offset3">
            <ul class="social-buttons">
              <li>
                <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=ekryski&amp;repo=caress-client&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="100px" height="20px"></iframe>
              </li>
              <li>
                <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=ekryski&amp;repo=caress-client&amp;type=fork&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="100px" height="20px"></iframe>
              </li>
              <li class="follow-btn">
                <a href="https://twitter.com/ekryski" class="twitter-follow-button" data-show-count="false">Follow @ekryski</a>
              </li>
              <li class="tweet-btn">
                <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://erickryski.com/caress-client" data-text="I just touched my browser with Caress">Tweet</a>
              </li>
            </ul>
          </div>
        </div> --><!-- ./row -->
        <div class="row">
          <div class="span12">
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam fringilla eros nec mauris ullamcorper ut ullamcorper dui euismod. Fusce vitae lacus eros, eget dictum urna. Praesent pulvinar auctor varius. Fusce sem orci, aliquam quis suscipit vel, scelerisque a lorem. In nisl est, egestas et ornare sed, consectetur sed erat. Nam et eleifend metus. Integer quis ipsum lacus. Fusce non scelerisque augue. Donec non odio lorem, eu dignissim nunc.</p>

            <p>Mauris ut justo a odio porta gravida. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Suspendisse dapibus ligula ac mauris auctor fringilla. Suspendisse potenti. Duis nunc sem, scelerisque vel iaculis quis, euismod eget arcu. Praesent varius pretium mauris a dignissim. Vestibulum feugiat velit ac nisl convallis in malesuada turpis accumsan.</p>

            <p>Nam aliquet ipsum eu libero pulvinar at venenatis lectus tristique. Sed ac pretium nisi. Integer mi risus, hendrerit eu mattis eu, consectetur pharetra arcu. Pellentesque ut sem vel tortor fringilla ultricies faucibus id lectus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Sed nulla mauris, fermentum eget molestie id, dignissim a urna. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Curabitur cursus molestie est, in ullamcorper ipsum posuere in. Suspendisse a odio eu lectus aliquam blandit ut sit amet elit. Sed ut tellus mauris, in eleifend nisl. In viverra felis non quam mattis tempor. Vivamus dictum dapibus ligula ac accumsan. Vivamus sapien eros, ultrices in commodo ut, iaculis pellentesque urna. Cras vitae risus ut massa mattis venenatis.</p>

            <p>Ut consectetur nibh at libero condimentum facilisis. Maecenas id libero sem. Nullam luctus erat in justo convallis ornare eget vitae lorem. Donec dictum orci vel lectus tempus commodo. Curabitur vel eleifend lacus. Sed id interdum arcu. Suspendisse potenti. Maecenas lectus nunc, laoreet non porta eu, convallis nec neque. Proin dignissim velit tellus, ut cursus sapien. Maecenas dui arcu, porta id vestibulum ac, facilisis ac nibh. Praesent et enim magna, sed posuere odio. Quisque dolor eros, laoreet in euismod tempor, auctor eget orci.</p>

            <p>Nam molestie, leo ac vehicula egestas, diam urna consequat lorem, eu rutrum mi elit non enim. Quisque vel mauris mi. Sed viverra consequat leo. Vestibulum gravida, neque vel mollis tincidunt, nulla odio mollis ligula, vel scelerisque est urna rhoncus massa. In quis quam sed dolor ultrices egestas. Cras at ultricies dolor. Etiam nisi mi, lacinia eu lacinia sit amet, dapibus at orci. Quisque adipiscing malesuada dictum. Vestibulum eu diam nec libero interdum vestibulum sit amet a nibh. Suspendisse viverra augue sit amet nulla mollis viverra. Sed nec ante sapien. Pellentesque auctor dictum erat sit amet placerat. Ut faucibus scelerisque orci, quis varius turpis congue nec.</p>
          </div>
        </div>
      </div>
      <div id="push"></div>
    </div><!-- ./wrap -->

    <!-- Footer
    ================================================== -->
    <footer class="footer">
      <div class="container">
        <p>Copyright Eric Kryski <a href="http://twitter.com/ekryski" target="_blank">@ekryski</a></p>
        <p>Code is <a href="https://github.com/ekryski/caress-client/blob/master/LICENSE" target="_blank">MIT Licensed</a>.</p>
      </div>
    </footer>
    <canvas id="canvas" width="800" height="600">Get a better browser. You are missing out!</canvas>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="js/underscore-1.3.3.min.js"></script>
    <script type="text/javascript" src="js/socket.io-0.9.10.min.js"></script>
    <script type="text/javascript" src="js/caress-0.1.0.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="http://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>
    <script>
        $(function() {
            window.client = new Caress.Client({
                host: 'localhost',
                port: 5000
            });
            client.connect();
        });
    </script>
    <script>
      var ongoingTouches = new Array;

      function colorForTouch(touch) {
        var id = touch.identifier;
        var letters = '0123456789ABCDEF'.split('');
        var color = '#';
        for (var i = 0; i < 6; i++ ) {
            color += letters[Math.round(Math.random() * 15)];
        }
        return color;
      }

      function ongoingTouchIndexById(idToFind) {
        for (var i=0; i<ongoingTouches.length; i++) {
          var id = ongoingTouches[i].identifier;

          if (id == idToFind) {
            return i;
          }
        }
        return -1;    // not found
      }

      function handleStart(evt) {
        evt.preventDefault();
        var el = document.getElementById("canvas");
        var ctx = el.getContext("2d");
        var touches = evt.changedTouches;

        for (var i=0; i<touches.length; i++) {
          var touch = touches[i];
          touch.color = colorForTouch(touch);
          ongoingTouches.push(touch);
          ctx.strokStyle = touch.color;
          ctx.fillRect(touch.pageX-2, touch.pageY-2, 4, 4);
        }
      }

      function handleMove(evt) {
        evt.preventDefault();
        var el = document.getElementById("canvas");
        var ctx = el.getContext("2d");
        var touches = evt.changedTouches;

        ctx.lineWidth = 4;

        for (var i=0; i<touches.length; i++) {
          var newTouch = touches[i];
          var idx = ongoingTouchIndexById(newTouch.identifier);
          var currentTouch = ongoingTouches[idx];
          
          newTouch.color = currentTouch.color;
          ctx.strokeStyle = currentTouch.color;
          ctx.beginPath();
          ctx.moveTo(currentTouch.pageX, currentTouch.pageY);
          ctx.lineTo(newTouch.pageX, newTouch.pageY);
          ctx.closePath();
          ctx.stroke();
          ongoingTouches.splice(idx, 1, newTouch);  // swap in the new touch record
        }
      }

      function handleEnd(evt) {
        evt.preventDefault();
        var el = document.getElementById("canvas");
        var ctx = el.getContext("2d");
        var touches = evt.changedTouches;

        ctx.lineWidth = 4;

        for (var i=0; i<touches.length; i++) {
          var touch = touches[i];
          touch.color = colorForTouch(touch);
          var idx = ongoingTouchIndexById(touch.identifier);

          ctx.strokeStyle = touch.color;
          ctx.beginPath();
          ctx.moveTo(ongoingTouches[i].pageX, ongoingTouches[i].pageY);
          ctx.lineTo(touch.pageX, touch.pageY);
          ongoingTouches.splice(i, 1);  // remove it; we're done
        }
      }

      function handleCancel(evt) {
        evt.preventDefault();
        var touches = evt.changedTouches;

        for (var i=0; i<touches.length; i++) {
          ongoingTouches.splice(i, 1);  // remove it; we're done
        }
      }


      function startup() {
        var el = document.getElementById("canvas");
        el.addEventListener("touchstart", handleStart, false);
        el.addEventListener("touchend", handleEnd, false);
        el.addEventListener("touchcancel", handleCancel, false);
        el.addEventListener("touchleave", handleEnd, false);
        el.addEventListener("touchmove", handleMove, false);
      }
    </script>
    <script type="text/javascript">
      $(document).ready(function(){
        var headerThreshold = $('.navbar').offset().top;

        function onScroll(e) {
          if (window.scrollY >= headerThreshold){
            $('.navbar').removeClass('navbar-transparent').addClass('navbar-fixed-top');
            $('.navbar:first-child').addClass('navbar-inner');
          }
          else {
            $('.navbar').addClass('navbar-transparent').removeClass('navbar-fixed-top');
            $('.navbar:first-child').removeClass('navbar-inner');
          }
        }

        $(window).resize(function(){
          var canvas = document.getElementById('canvas');

          canvas.width  = window.innerWidth;
          canvas.height = window.innerHeight;

          headerThreshold = $('.navbar').offset().top;
          // $('.navbar:first-child').removeClass('navbar-inner');

          if ($(window).width() <= 979) {
            $('.navbar').removeClass('navbar-transparent').addClass('navbar-fixed-top');
            // $('.navbar:first-child').addClass('navbar-inner');
          }
          else {
            $('.navbar').addClass('navbar-transparent').removeClass('navbar-fixed-top');
            // $('.navbar:first-child').removeClass('navbar-inner');
          }
        }).resize();

        $(document).on('scroll', onScroll);
        startup();
      });
    </script>
  </body>
</html>
